import{R as e,W as t,aj as a,ak as l,X as n,I as r,Y as m,r as i,m as s,T as c,al as o,am as u,an as d,J as E}from"./vendor.4b163024.js";import{u as g,c as p}from"./index.28e8633a.js";import{C as f}from"./index.982655a1.js";var h=i=>{const{formConfig:s,onFinish:c,configLoading:o}=i;return e.createElement("div",{className:"swagger-config"},e.createElement(t,{name:"form_config",form:s,onFinish:c,labelCol:{span:10}},e.createElement("div",{className:"form-item-title"},"JSON模拟数据相关："),e.createElement(t.Item,{name:"json_checked",valuePropName:"checked",label:"生成JSON模拟数据"},e.createElement(a,null)),e.createElement("div",{className:"form-item-title"},"MockJS相关："),e.createElement(t.Item,{name:"mock_checked",valuePropName:"checked",label:"生成MockJS模拟数据"},e.createElement(a,null)),e.createElement(t.Item,{name:"mock_fileType",label:"mock文件类型",initialValue:"js",rules:[{required:!0,message:"请选择"}]},e.createElement(l.Group,{buttonStyle:"solid"},e.createElement(l.Button,{value:"ts"},"TypeScript"),e.createElement(l.Button,{value:"js"},"JavaScript"))),e.createElement("div",{className:"form-item-title"},"API相关："),e.createElement(t.Item,{name:"requestLibPath",label:"requestLibPath",rules:[{required:!0,message:"请输入"}],tooltip:{title:"request的导入请求头",icon:e.createElement(n,null)}},e.createElement(r,null)),e.createElement(t.Item,{name:"api_fileType",label:"生成文件类型",rules:[{required:!0,message:"请选择"}]},e.createElement(l.Group,{buttonStyle:"solid"},e.createElement(l.Button,{value:"ts"},"TypeScript"),e.createElement(l.Button,{value:"js"},"JavaScript"))),e.createElement(t.Item,{name:"outputFileType",label:"多文件",rules:[{required:!0,message:"请选择"}],tooltip:{title:"导出的多个api是否合并成一个文件",icon:e.createElement(n,null)}},e.createElement(l.Group,{buttonStyle:"solid"},e.createElement(l.Button,{value:"merge"},"合并"),e.createElement(l.Button,{value:"none"},"不合并"))),e.createElement(t.Item,{noStyle:!0,shouldUpdate:!0},(({getFieldValue:a})=>"merge"===a("outputFileType")?e.createElement(t.Item,{name:"outputFileName",label:"导出文件名称",rules:[{required:!0,message:"请输入"}],initialValue:"serve.ts",shouldUpdate:!0},e.createElement(r,null)):null)),e.createElement(t.Item,{name:"filterPathPrefix",label:"需要过滤的api前缀",tooltip:{title:"此配置/crm/api/getList可过滤为 /getList",icon:e.createElement(n,null)}},e.createElement(r,{placeholder:"例如：api"})),e.createElement(t.Item,{style:{paddingLeft:208}},e.createElement(m,{type:"primary",htmlType:"submit",loading:o},"保存"))))},y=({data:a})=>{const[l]=t.useForm(),[n,c]=i.exports.useState(""),{loading:o,request:u}=g("/api/config/savePrivateConfig",{lazy:!0});i.exports.useEffect((()=>{a&&a&&l.setFieldsValue(a)}),[a]);return e.createElement("div",{className:"swagger-config",style:{width:550}},e.createElement(t,{name:"form_config",form:l,onFinish:e=>{u(e).then((t=>{s.success("保存完成"),c(e.access_token)}))},labelCol:{span:10}},e.createElement("div",{className:"info",style:{padding:"5px 0 10px 25px"}},e.createElement("p",{style:{color:"#ff0000"}},"声明：该项目所有配置都是本地存储，不会上传任何数据！"),e.createElement("p",null,"因github的下载文件api有次数限制，可配置access_token无限制下载。 ",e.createElement("br",null),e.createElement("a",{href:"https://api.github.com/users/octocat",target:"_blank"},"【查询是否限制】")," ","   ",e.createElement("a",{href:`https://api.github.com/rate_limit?access_token=${n||a&&a.access_token||""}`,target:"_blank"},"【查看我的次数】")," ","   ",e.createElement("a",{href:"https://www.yuque.com/qqhh/cuq2ci/hzv2kt",target:"_blank"},"【如何配置token】"))),e.createElement(t.Item,{name:"access_token",label:"github 的 access_token",rules:[{required:!0,message:"请输入"}]},e.createElement(r,null)),e.createElement(t.Item,{style:{paddingLeft:208}},e.createElement(m,{type:"primary",htmlType:"submit",loading:o},"保存"))))};const{TabPane:b}=c;var k=()=>{const[a]=t.useForm(),[l]=t.useForm(),[n]=t.useForm(),{query:k}=p(),[v,w]=i.exports.useState("1"),{data:q,request:I}=g("/api/config/get"),{request:S,loading:_}=g("/api/config/swagger/add",{lazy:!0}),{request:x}=g("/api/config/swagger/remove",{lazy:!0}),{request:F,loading:N}=g("/api/swagger/saveConfig",{lazy:!0}),{request:T,loading:C}=g("/api/block/pushItem",{lazy:!0}),{request:P}=g("/api/block/removeItem",{lazy:!0});i.exports.useEffect((()=>{k&&k.key&&w(k.key)}),[]),i.exports.useEffect((()=>{q&&q.swaggerConfig&&n.setFieldsValue(q.swaggerConfig)}),[q]);const z=[{title:"名称",dataIndex:"name",key:"name",width:100},{title:"链接",dataIndex:"href",key:"href",width:200},{title:"操作",width:70,render:(t,a)=>a.default?null:e.createElement("a",{onClick:()=>(e=>{x({id:e.id}).then((e=>{I()}))})(a),key:a.id},"删除")}],j=[{title:"名称",dataIndex:"name",key:"name"},{title:"链接",dataIndex:"href",key:"href"},{title:"默认",dataIndex:"default",key:"default",render:(t,a)=>"1"===String(t)?e.createElement("span",{key:a.id},"是"):e.createElement("span",{key:a.id},"否")},{title:"操作",render:(t,a)=>a.default?e.createElement("span",{key:a.id},"无"):e.createElement("a",{onClick:()=>(e=>{P({id:e.id}).then((e=>{I()}))})(a),key:a.id},"删除")}];return e.createElement(f,{isMain:!0,title:"配置",className:"ui-config-content"},e.createElement("div",{className:"scroll-body ui-config-container ui-content-container"},e.createElement(c,{className:"tabs-oumi",type:"card",activeKey:v,onChange:e=>w(e)},e.createElement(b,{tab:"Swagger",key:"1"},e.createElement(o,null,e.createElement(u,{span:11},e.createElement("h3",null,"API导出配置"),e.createElement(h,{formConfig:n,onFinish:e=>{F(e).then((e=>{s.success("保存成功")}))},configLoading:N})),e.createElement(u,{span:13},e.createElement("h3",null,"Swagger列表"),e.createElement(t,{name:"form_add",form:a,layout:"inline",onFinish:e=>{S(e).then((e=>{a.resetFields(),I()}))}},e.createElement(t.Item,{name:"name",label:"名称",rules:[{required:!0,message:"请输入Swagger名称"}]},e.createElement(r,null)),e.createElement(t.Item,{name:"href",label:"链接",rules:[{required:!0,validator:(e,t)=>{const a=new RegExp(/^[A-Za-z]+:\/\/[A-Za-z0-9-_]+.[A-Za-z0-9-_%&\\?\\/.:=]+$/);return t&&a.test(t)?Promise.resolve():Promise.reject(new Error("请输入一个正确的链接"))},message:"请输入一个正确的链接"}]},e.createElement(r,null)),e.createElement(t.Item,null,e.createElement(m,{type:"primary",htmlType:"submit",loading:_},"新增"))),e.createElement("div",{style:{width:700,marginTop:50}},e.createElement(d,{rowKey:"id",title:()=>"我的 Swagger",bordered:!0,dataSource:q&&q.swagger?q.swagger:[],columns:z,pagination:!1}))))),e.createElement(b,{tab:"资产配置",key:"2"},e.createElement("h3",null,"资产列表"),e.createElement(t,{name:"form_block",form:l,layout:"inline",onFinish:e=>{T(e).then((e=>{s.success("保存成功"),l.resetFields(),I()}))}},e.createElement(t.Item,{name:"name",label:"名称",rules:[{required:!0,message:"请输入资产名称"}]},e.createElement(r,null)),e.createElement(t.Item,{name:"href",label:"资产路径",rules:[{required:!0,message:"请输入一个正确的资产路径"}]},e.createElement(r,null)),e.createElement(t.Item,null,e.createElement(E,null,e.createElement(m,{type:"primary",htmlType:"submit",loading:C},"新增"),e.createElement("a",{href:"https://www.yuque.com/qqhh/cuq2ci/vpg4rw",target:"_blank"},"如何配置？")))),e.createElement("div",{style:{width:800,marginTop:50}},e.createElement(d,{rowKey:"id",title:()=>"资产列表",bordered:!0,dataSource:q&&q.blocks?q.blocks:[],columns:j,pagination:!1}))),e.createElement(b,{tab:"私有配置",key:"3"},e.createElement(y,{data:q&&q.private})))))};export{k as default};
