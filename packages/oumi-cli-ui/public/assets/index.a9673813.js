var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,c=(e,t)=>{for(var r in t||(t={}))a.call(t,r)&&s(e,r,t[r]);if(n)for(var r of n(t))o.call(t,r)&&s(e,r,t[r]);return e},l=(e,n)=>t(e,r(n));import{R as i,S as p,a as m,G as u,b as d,i as E,c as f,u as h,d as _,e as x,f as g,L as b,H as k,M as y,g as j,h as v,j as O,A as P,k as S,B as C,l as w}from"./vendor.da7d838d.js";let D;const L={},T=function(e,t){if(!t||0===t.length)return e();if(void 0===D){const e=document.createElement("link").relList;D=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if(e in L)return;L[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":D,t||(n.as="script",n.crossOrigin=""),n.href=e,document.head.appendChild(n),t?new Promise(((e,t)=>{n.addEventListener("load",e),n.addEventListener("error",t)})):void 0}))).then((()=>e()))};function I(e){var t;return(t=class extends i.Component{constructor(){super(...arguments),this.state={Component:t.Component}}componentDidMount(){this.state.Component||e().then((({default:e})=>{t.Component=e,this.setState({Component:e})}))}render(){const{Component:e}=this.state;return e?i.createElement(e,c({},this.props)):i.createElement("div",{style:{padding:20}},"页面加载中...")}}).Component=null,t}function A(e,t={},r={}){return e?i.createElement(p,c({},r),e.map(((e,r)=>i.createElement(m,{key:e.key||r,path:e.path,exact:e.exact,strict:e.strict,render:r=>e.render?e.render(l(c(c({},r),t),{route:e})):i.createElement(e.component,l(c(c({},r),t),{route:e}))})))):null}const R=u.create({timeout:15e3});R.interceptors.response.use((e=>{if(e&&e.data&&!0===e.data.success)return e.data.data;const{config:t,data:r}=e,n=r&&r.msg?r.msg:"系统繁忙~";return!t||void 0!==t.errorMsg&&!0!==t.errorMsg||(d.destroy(),d.error(n)),Promise.reject(e.data)}),(e=>Promise.reject(e)));const M=E(window.location.origin);M.on("connect",(()=>{window.console.log("socket.connected")}));const N=f.exports.createContext({socket:M}),V=()=>f.exports.useContext(N),q=(e,t)=>{const{params:r,methods:n="post",lazy:a=!1,errorMsg:o=!0,onSuccess:s,onError:l}=t||{},[i,p]=f.exports.useState(a),[m]=f.exports.useState(u.CancelToken.source()),[d,E]=f.exports.useState(null),[h,_]=f.exports.useState(null),[x,g]=f.exports.useState(!1),b=f.exports.useCallback(((t,a)=>(g(!0),new Promise(((i,p)=>{R[n](e,c(c({},r),t),{errorMsg:o,cancelToken:m.token}).then((e=>{g(!1),_(e),"function"==typeof s&&s(e),a&&"function"==typeof a.onSuccess&&a.onSuccess(e),i(e)})).catch((e=>{g(!1),E(e),"function"==typeof l&&l(e),a&&"function"==typeof a.onError&&a.onError(e),p(e)}))})))),[r]);return f.exports.useEffect((()=>{!1===i&&b(),p(!0)}),[b,i,r]),{error:d,data:h,source:m,setData:_,loading:x,request:b}},z=()=>{const e=h(),t=_();return Object.assign(e,t),e.query=x.parse(e.search.substr(1)),e};var B=e=>{const t=g(),[r,n]=f.exports.useState(""),{data:a,error:o,request:s}=q("/api/dashboard/init",{errorMsg:!1,lazy:!0});f.exports.useEffect((()=>{s()}),[]),f.exports.useEffect((()=>{o&&t.replace("/project/select")}),[o]),f.exports.useEffect((()=>{const{location:e}=t;let r=e.pathname;r.startsWith("/tasks")&&(r="/tasks"),n(r)}),[t,t.location]);return o?i.createElement("div",{style:{padding:50}},i.createElement(b,{to:"/project/select"},"选择项目")):i.createElement("div",{className:"ui-slider"},i.createElement("header",{onClick:()=>{t.push("/project/select")}},i.createElement("div",{className:"icon",title:"Oumi 项目过滤器"},i.createElement(k,{style:{fontSize:18}})),i.createElement("div",{className:"project-name"},a&&a.name)),i.createElement("div",{className:"slider-list"},W.map((e=>i.createElement("div",{className:"slider-list-item "+(r===e.path?"active":""),key:e.path},i.createElement(b,{to:e.path},e.icon,e.name))))),i.createElement("div",{className:"contact-me"},i.createElement("a",{href:"mailto:345263463@qq.com"},i.createElement(y,null)," 向我反馈")))};const W=[{name:"任务",path:"/tasks",icon:i.createElement(v,null)},{name:"资产",path:"/blocks",icon:i.createElement(O,null)},{name:"Swagger",path:"/swagger",icon:i.createElement(P,null)},{name:"配置",path:"/config",icon:i.createElement(S,null)}],$=[{component:({route:e})=>{const t=g(),[r,n]=f.exports.useState(!1);return f.exports.useEffect((()=>{const{location:e}=t;n("/project/select"!==e.pathname)}),[t,t.location]),i.createElement(i.Fragment,null,r&&i.createElement(B,null),i.createElement("div",{className:"root-container"},A(e.routes)))},routes:[{path:"/",label:"首页",exact:!0,component:()=>i.createElement(j,{to:"/tasks"})},{path:"/project/select",label:"选择项目",exact:!0,component:I((()=>T((()=>import("./index.3e519ba7.js")),["/assets/index.3e519ba7.js","/assets/index.11f3719d.css","/assets/vendor.da7d838d.js"])))},{path:"/dashboard",label:"Dashboard",exact:!0,component:I((()=>T((()=>import("./index.d67defd1.js")),["/assets/index.d67defd1.js","/assets/vendor.da7d838d.js","/assets/index.09639539.js","/assets/index.c44fabc9.css"])))},{path:"/swagger",label:"Swagger",exact:!0,component:I((()=>T((()=>import("./index.7c402b37.js")),["/assets/index.7c402b37.js","/assets/index.cacf812f.css","/assets/vendor.da7d838d.js","/assets/index.09639539.js","/assets/index.c44fabc9.css"])))},{path:"/tasks",label:"Tasks",component:I((()=>T((()=>import("./index.8849a442.js")),["/assets/index.8849a442.js","/assets/index.78cdc390.css","/assets/vendor.da7d838d.js","/assets/index.09639539.js","/assets/index.c44fabc9.css"])))},{path:"/tasks/:id",label:"Tasks",component:I((()=>T((()=>import("./index.8849a442.js")),["/assets/index.8849a442.js","/assets/index.78cdc390.css","/assets/vendor.da7d838d.js","/assets/index.09639539.js","/assets/index.c44fabc9.css"])))},{path:"/blocks",label:"Blocks",exact:!0,component:I((()=>T((()=>import("./index.4ad9ca27.js")),["/assets/index.4ad9ca27.js","/assets/index.d177f23e.css","/assets/vendor.da7d838d.js","/assets/index.09639539.js","/assets/index.c44fabc9.css"])))},{path:"/config",label:"Config",exact:!0,component:I((()=>T((()=>import("./index.0352d12f.js")),["/assets/index.0352d12f.js","/assets/index.188218b6.css","/assets/vendor.da7d838d.js","/assets/index.09639539.js","/assets/index.c44fabc9.css"])))}]}];function F(){return i.createElement(C,null,A($))}w.render(i.createElement(N.Provider,{value:{socket:M}},i.createElement(F,null)),document.getElementById("root"));export{V as a,z as b,R as i,q as u};
