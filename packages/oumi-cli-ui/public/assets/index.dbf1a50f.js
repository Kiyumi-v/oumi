var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,s=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,c=(e,t)=>{for(var r in t||(t={}))o.call(t,r)&&s(e,r,t[r]);if(n)for(var r of n(t))a.call(t,r)&&s(e,r,t[r]);return e},l=(e,n)=>t(e,r(n)),i=(e,t,r)=>(s(e,"symbol"!=typeof t?t+"":t,r),r);import{R as p,S as m,a as u,b as d,m as E,i as f,r as h,u as g,c as _,l as b,d as y,L as x,D as k,e as j,C as v,M as O,f as P,H as w,g as C,h as D,j as I,k as S,n as L,o as T,A,B as q,p as R,q as V,s as N}from"./vendor.2fb83dc5.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const M={},z=function(e,t){return t&&0!==t.length?Promise.all(t.map((e=>{if((e=`/${e}`)in M)return;M[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script",n.crossOrigin=""),n.href=e,document.head.appendChild(n),t?new Promise(((e,t)=>{n.addEventListener("load",e),n.addEventListener("error",t)})):void 0}))).then((()=>e())):e()};function B(e){var t;return t=class extends p.Component{constructor(){super(...arguments),i(this,"state",{Component:t.Component})}componentDidMount(){this.state.Component||e().then((({default:e})=>{t.Component=e,this.setState({Component:e})}))}render(){const{Component:e}=this.state;return e?p.createElement(e,c({},this.props)):p.createElement("div",{style:{padding:20}},"页面加载中...")}},i(t,"Component",null),t}function $(e,t={},r={}){return e?p.createElement(m,c({},r),e.map(((e,r)=>p.createElement(u,{key:e.key||r,path:e.path,exact:e.exact,strict:e.strict,render:r=>e.render?e.render(l(c(c({},r),t),{route:e})):p.createElement(e.component,l(c(c({},r),t),{route:e}))})))):null}const W=d.create({timeout:15e3});W.interceptors.response.use((e=>{if(e&&e.data&&!0===e.data.success)return e.data.data;const{config:t,data:r}=e,n=r&&r.msg?r.msg:"系统繁忙~";return!t||void 0!==t.errorMsg&&!0!==t.errorMsg||(E.destroy(),E.error(n)),Promise.reject(e.data)}),(e=>Promise.reject(e)));const F=f(window.location.origin);F.on("connect",(()=>{window.console.log("socket.connected")})),F.on("error",(e=>{window.console.log("socket.error",e)}));const G=h.exports.createContext({socket:F}),H=()=>h.exports.useContext(G),K=(e,t)=>{const{params:r,methods:n="post",lazy:o=!1,errorMsg:a=!0,onSuccess:s,onError:l}=t||{},[i,p]=h.exports.useState(o),[m]=h.exports.useState(d.CancelToken.source()),[u,E]=h.exports.useState(null),[f,g]=h.exports.useState(null),[_,b]=h.exports.useState(!1),y=h.exports.useCallback(((t,o)=>(b(!0),new Promise(((i,p)=>{W[n](e,c(c({},r),t),{errorMsg:a,cancelToken:m.token}).then((e=>{b(!1),g(e),"function"==typeof s&&s(e),o&&"function"==typeof o.onSuccess&&o.onSuccess(e),i(e)})).catch((e=>{b(!1),E(e),"function"==typeof l&&l(e),o&&"function"==typeof o.onError&&o.onError(e),p(e)}))})))),[r]);return h.exports.useEffect((()=>{!1===i&&y(),p(!0)}),[y,i,r]),{error:u,data:f,source:m,setData:g,loading:_,request:y}},J=()=>{const e=g(),t=_();return Object.assign(e,t),e.query=b.parse(e.search.substr(1)),e};var Q=e=>{const t=y(),[r,n]=h.exports.useState(""),[o,a]=h.exports.useState(!1),{request:s,data:c=[]}=K("/api/project/list"),{request:l}=K("/api/project/dashboard",{lazy:!0}),{request:i}=K("/api/openInEditor",{lazy:!0}),{data:m,error:u,request:d}=K("/api/dashboard/init",{errorMsg:!1,lazy:!0});h.exports.useEffect((()=>{a(!0),d().then((()=>{a(!1)})).catch((()=>{a(!1)}))}),[]),h.exports.useEffect((()=>{u&&t.replace("/project/select")}),[u]),h.exports.useEffect((()=>{const{location:e}=t;let r=e.pathname;r.startsWith("/tasks")&&(r="/tasks"),n(r)}),[t,t.location]);const E=()=>{t.push("/project/select")},f=async()=>{if(m){a(!0);try{await i({input:{file:m.path}}),a(!1)}catch(e){a(!1)}}};return m?u?p.createElement("div",{style:{padding:50}},p.createElement(x,{to:"/project/select"},"选择项目")):p.createElement("div",{className:"ui-slider"},p.createElement("header",null,p.createElement(k,{arrow:!0,placement:"bottomCenter",overlay:()=>p.createElement(P,null,p.createElement(P.Item,{key:"3",onClick:E},p.createElement(w,null)," Oumi 管理器"),p.createElement(P.Item,{key:"1",onClick:f},p.createElement(C,null)," 在编辑器中打开"),p.createElement(P.Divider,null),p.createElement(P.ItemGroup,{title:"收藏的项目"},c&&c.filter((e=>!!e.collection&&m&&e.id!==m.id)).map((e=>p.createElement(P.Item,{key:e.id,onClick:()=>(e=>{l({id:e.id}).then((()=>{window.location.reload()}))})(e)}," ",p.createElement(D,null)," ",e.name," "))))),trigger:["click"]},p.createElement("div",{className:"search"},m.name,o?p.createElement(j,{size:"small"}):p.createElement(v,null)))),p.createElement("div",{className:"slider-list"},U.map((e=>p.createElement("div",{className:"slider-list-item "+(r===e.path?"active":""),key:e.path},p.createElement(x,{to:e.path},e.icon,e.name))))),p.createElement("div",{className:"contact-me"},p.createElement("a",{href:"mailto:345263463@qq.com"},p.createElement(O,null)," 向我反馈"))):null};const U=[{name:"任务",path:"/tasks",icon:p.createElement(S,null)},{name:"依赖",path:"/deps",icon:p.createElement(L,null)},{name:"资产",path:"/blocks",icon:p.createElement(T,null)},{name:"Swagger",path:"/swagger",icon:p.createElement(A,null)},{name:"接口调试",path:"/debugger",icon:p.createElement(q,null)},{name:"配置",path:"/config",icon:p.createElement(R,null)}],X=[{component:({route:e})=>{const t=y(),[r,n]=h.exports.useState(!1);return h.exports.useEffect((()=>{const{location:e}=t;n("/project/select"!==e.pathname)}),[t,t.location]),p.createElement(p.Fragment,null,r&&p.createElement(Q,null),p.createElement("div",{className:"root-container"},$(e.routes)))},routes:[{path:"/",label:"首页",exact:!0,component:()=>p.createElement(I,{to:"/tasks"})},{path:"/project/select",label:"选择项目",exact:!0,component:B((()=>z((()=>import("./index.5b99952f.js")),["assets/index.5b99952f.js","assets/index.0ab7a36a.css","assets/vendor.2fb83dc5.js"])))},{path:"/dashboard",label:"Dashboard",exact:!0,component:B((()=>z((()=>import("./index.2f2170b6.js")),["assets/index.2f2170b6.js","assets/vendor.2fb83dc5.js","assets/index.cd6435fb.js","assets/index.778dcec8.css"])))},{path:"/swagger",label:"Swagger",exact:!0,component:B((()=>z((()=>import("./index.aa6b2cb1.js")),["assets/index.aa6b2cb1.js","assets/index.ecd78ed0.css","assets/vendor.2fb83dc5.js","assets/index.03ffb951.js","assets/index.cd6435fb.js","assets/index.778dcec8.css","assets/index.25e46318.js"])))},{path:"/tasks",label:"Tasks",component:B((()=>z((()=>import("./index.e291ae70.js")),["assets/index.e291ae70.js","assets/index.b11d4c50.css","assets/vendor.2fb83dc5.js","assets/index.cd6435fb.js","assets/index.778dcec8.css","assets/event.cbc5772f.js","assets/index.03ffb951.js"])))},{path:"/tasks/:id",label:"Tasks",component:B((()=>z((()=>import("./index.e291ae70.js")),["assets/index.e291ae70.js","assets/index.b11d4c50.css","assets/vendor.2fb83dc5.js","assets/index.cd6435fb.js","assets/index.778dcec8.css","assets/event.cbc5772f.js","assets/index.03ffb951.js"])))},{path:"/blocks",label:"Blocks",exact:!0,component:B((()=>z((()=>import("./index.e18c9d73.js")),["assets/index.e18c9d73.js","assets/index.b50aae06.css","assets/vendor.2fb83dc5.js","assets/index.cd6435fb.js","assets/index.778dcec8.css"])))},{path:"/config",label:"Config",exact:!0,component:B((()=>z((()=>import("./index.9616ba40.js")),["assets/index.9616ba40.js","assets/index.77952f6c.css","assets/vendor.2fb83dc5.js","assets/index.cd6435fb.js","assets/index.778dcec8.css"])))},{path:"/deps",label:"Deps",exact:!0,component:B((()=>z((()=>import("./index.9165077e.js")),["assets/index.9165077e.js","assets/index.2114993f.css","assets/vendor.2fb83dc5.js","assets/index.cd6435fb.js","assets/index.778dcec8.css","assets/event.cbc5772f.js"])))},{path:"/debugger",label:"Debugger",exact:!0,component:B((()=>z((()=>import("./index.1ca799f0.js")),["assets/index.1ca799f0.js","assets/index.5b963c2b.css","assets/vendor.2fb83dc5.js","assets/index.03ffb951.js","assets/index.25e46318.js"])))},{path:"/debugger/:id",label:"Debugger",exact:!0,component:B((()=>z((()=>import("./index.1ca799f0.js")),["assets/index.1ca799f0.js","assets/index.5b963c2b.css","assets/vendor.2fb83dc5.js","assets/index.03ffb951.js","assets/index.25e46318.js"])))}]}];function Y(){return p.createElement(V,null,$(X))}N.render(p.createElement(G.Provider,{value:{socket:F}},p.createElement(Y,null)),document.getElementById("root"));export{H as a,J as b,W as i,K as u};
