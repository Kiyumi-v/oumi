var b=Object.defineProperty,A=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var P=(n,l,r)=>l in n?b(n,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[l]=r,y=(n,l)=>{for(var r in l||(l={}))S.call(l,r)&&P(n,r,l[r]);if(k)for(var r of k(l))q.call(l,r)&&P(n,r,l[r]);return n},j=(n,l)=>A(n,O(l));import{r as C,e as z,R as e,T as F,U as B,E as D,f as I,s as R,I as w,t as T,v as _,F as K,w as L,x as U,h as $,y as V,g as G,z as H,G as J}from"./vendor.25eb60fb.js";import{u as d,i as M}from"./index.22863799.js";const{TabPane:x}=F,Q=({projectList:n=[],getProjectList:l,removeProject:r,goDashboard:s})=>{const[i,o]=C.exports.useState(null),{request:u,loading:E}=d("/api/openInEditor",{lazy:!0}),{request:f}=d("/api/project/collect",{lazy:!0});if(!Array.isArray(n))return null;const v=c=>{E||(o(c),u({input:{file:c.path}}))},h=async(c,a,t)=>{c.stopPropagation(),c.preventDefault(),await f({id:a.id,collect:!t}),l()},p=n.filter(c=>c.collection),N=n.filter(c=>!c.collection);function m(c,a){return Array.isArray(c)?c.map(t=>e.createElement("div",{className:"project-select-list-item",key:t.id},e.createElement("div",{className:"content"},e.createElement("div",{className:"content-icon cur",onClick:g=>h(g,t,a)},!a&&e.createElement($,{style:{fontSize:22}}),a&&e.createElement(V,{style:{fontSize:22,color:"#1890ff"}})),e.createElement("div",{className:"content-left",onClick:()=>s({id:t.id})},e.createElement("div",{className:"name"},t.name),e.createElement("div",{className:"path"},t.path)),e.createElement("div",{className:"content-right"},e.createElement("span",{className:"open",onClick:()=>v(t)},e.createElement(G,null)," \u5728\u7F16\u8F91\u5668\u4E2D\u6253\u5F00 ",E&&t===i&&e.createElement(H,null)),e.createElement("span",{className:"delete",onClick:()=>r(t)},e.createElement(J,null)))))):null}return e.createElement("section",{className:"project-select-list container-center tabs-content-auto"},p.length>0&&e.createElement("div",{className:"project-select-list__title"},"\u6536\u85CF\u9879\u76EE"),m(p,!0),e.createElement("div",{className:"project-select-list__title"},"\u66F4\u591A\u9879\u76EE"),m(N),n&&n.length===0&&e.createElement("div",{className:"empty flex-center"},"\u6CA1\u6709\u9879\u76EE\u54E6\uFF0C\u53BB\u5BFC\u5165\u5427~"))},W=({projectData:n,requestImportToProject:l,requestFiles:r})=>{C.exports.useRef(null);const[s,i]=C.exports.useState(!1),{currentPath:o=[],isPackage:u=!1,files:E=[]}=n||{},{request:f}=d("/api/project/verifyDirs",{lazy:!0}),v=(a,t)=>{if(t===o.length-1||!a)return;const g=[...o].splice(0,t+1);r({rootPathArr:g})},h=a=>{const t=[...o,a];r({rootPathArr:t})},p=()=>{const a=[...o];a.pop(),a.length>1&&r({rootPathArr:a})},N=()=>{u&&l({importPath:o})},m=a=>{const t=a.target.value.split("/");f({targetPath:t}).then(()=>{i(!1),r({rootPathArr:t})}).catch(()=>{i(!1)})},c=()=>{const a=document.getElementById("search-input");if(a&&a.value){const{value:t}=a;m({target:{value:t}})}i(!s)};return e.createElement("div",{className:"project-import container-center tabs-content-auto"},e.createElement("div",{className:"toolbar"},e.createElement("div",{className:"back flex-center",onClick:p},e.createElement(R,null)),e.createElement("div",{className:"current-path"},o.map((a,t)=>e.createElement("div",{key:a,className:"path-part flex-center",onClick:()=>v(a,t)},a)),s&&e.createElement("div",{className:"edit-path"},e.createElement(w,{id:"search-input",defaultValue:o.join("/"),onPressEnter:m}))),e.createElement("div",{className:"edit flex-center",onClick:c},!s&&e.createElement(T,null),s&&e.createElement(_,null))),e.createElement("div",{className:"folders"},e.createElement(X,{files:E,goNextFile:h})),e.createElement("div",{className:"import-btn"},e.createElement("button",{className:`${u?"":"disabled"}`,onClick:N},e.createElement(K,null)," \u5BFC\u5165\u8FD9\u4E2A\u6587\u4EF6\u5939")))},X=({files:n,goNextFile:l})=>e.createElement("div",null,n&&n.map(r=>e.createElement("div",{className:"folder-explorer-item",key:r,onClick:()=>l(r)},e.createElement("div",{className:"icon flex-center"},(()=>{const s={fontSize:18},i=j(y({},s),{color:"#168bff"});return r.includes(".json")?e.createElement(L,{style:y({},s)}):e.createElement(U,{style:i})})()),e.createElement("div",{className:"folder-name"},r))),n&&n.length===0&&e.createElement("div",{className:"empty flex-center"},"\u8BE5\u76EE\u5F55\u6CA1\u6709\u6587\u4EF6~"));var te=()=>{const[n,l]=C.exports.useState("1"),r=z(),{request:s,data:i,loading:o}=d("/api/user/folder",{errorMsg:!1}),{request:u,data:E=[],loading:f}=d("/api/project/list"),{request:v,loading:h}=d("/api/project/dashboard",{lazy:!0,onSuccess:()=>{r.push("/")}}),{request:p,loading:N}=d("/api/project/remove",{lazy:!0,onSuccess:()=>{c()}}),m=t=>{s(t)},c=t=>{u(t)},a=t=>{M.post("/api/project/import",y({},t)).then(g=>{c(),l("1")})};return e.createElement("section",{className:"ui-container"},e.createElement("div",{className:"title"},"Oumi UI \u9879\u76EE\u7BA1\u7406\u5668"),e.createElement("div",{className:"ui-tabs"},e.createElement(F,{defaultActiveKey:"1",activeKey:n,onChange:t=>l(t)},e.createElement(x,{key:"1",tab:e.createElement("span",null,e.createElement(B,null),"\u9879\u76EE")},e.createElement(Q,{projectList:E,getProjectList:u,removeProject:p,goDashboard:v})),e.createElement(x,{key:"2",tab:e.createElement("span",null,e.createElement(D,null),"\u5BFC\u5165")},e.createElement(W,{requestImportToProject:a,projectData:i,requestFiles:m}))),(o||f)&&e.createElement("div",{className:"loading flex-center"},e.createElement(I,null))))};export{te as default};
