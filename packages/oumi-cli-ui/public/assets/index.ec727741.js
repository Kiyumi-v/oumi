var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,l=(t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r,s=(e,t)=>{for(var a in t||(t={}))c.call(t,a)&&l(e,a,t[a]);if(r)for(var a of r(t))n.call(t,a)&&l(e,a,t[a]);return e};import{G as o,g as i,u as m,R as d,e as p}from"./vendor.88f6b8e8.js";import{I as u,u as v,T as f,S as h,L as E,C as g,a as b,i as x}from"./index.f4db9373.js";import{F as N,a as j,b as y}from"./FolderOutlined.c8c19ab8.js";var z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},O=function(e,t){return o.exports.createElement(u,Object.assign({},e,{ref:t,icon:z}))};O.displayName="ArrowLeftOutlined";var P=o.exports.forwardRef(O),w={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"},k=function(e,t){return o.exports.createElement(u,Object.assign({},e,{ref:t,icon:w}))};k.displayName="EditOutlined";var L=o.exports.forwardRef(k),C={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M516 673c0 4.4 3.4 8 7.5 8h185c4.1 0 7.5-3.6 7.5-8v-48c0-4.4-3.4-8-7.5-8h-185c-4.1 0-7.5 3.6-7.5 8v48zm-194.9 6.1l192-161c3.8-3.2 3.8-9.1 0-12.3l-192-160.9A7.95 7.95 0 00308 351v62.7c0 2.4 1 4.6 2.9 6.1L420.7 512l-109.8 92.2a8.1 8.1 0 00-2.9 6.1V673c0 6.8 7.9 10.5 13.1 6.1zM880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"code",theme:"outlined"},H=function(e,t){return o.exports.createElement(u,Object.assign({},e,{ref:t,icon:C}))};H.displayName="CodeOutlined";var V=o.exports.forwardRef(H),I={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888.3 757.4h-53.8c-4.2 0-7.7 3.5-7.7 7.7v61.8H197.1V197.1h629.8v61.8c0 4.2 3.5 7.7 7.7 7.7h53.8c4.2 0 7.7-3.4 7.7-7.7V158.7c0-17-13.7-30.7-30.7-30.7H158.7c-17 0-30.7 13.7-30.7 30.7v706.6c0 17 13.7 30.7 30.7 30.7h706.6c17 0 30.7-13.7 30.7-30.7V765.1c0-4.3-3.5-7.7-7.7-7.7zm18.6-251.7L765 393.7c-5.3-4.2-13-.4-13 6.3v76H438c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h314v76c0 6.7 7.8 10.5 13 6.3l141.9-112a8 8 0 000-12.6z"}}]},name:"export",theme:"outlined"},M=function(e,t){return o.exports.createElement(u,Object.assign({},e,{ref:t,icon:I}))};M.displayName="ExportOutlined";var q=o.exports.forwardRef(M),R={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M280 752h80c4.4 0 8-3.6 8-8V280c0-4.4-3.6-8-8-8h-80c-4.4 0-8 3.6-8 8v464c0 4.4 3.6 8 8 8zm192-280h80c4.4 0 8-3.6 8-8V280c0-4.4-3.6-8-8-8h-80c-4.4 0-8 3.6-8 8v184c0 4.4 3.6 8 8 8zm192 72h80c4.4 0 8-3.6 8-8V280c0-4.4-3.6-8-8-8h-80c-4.4 0-8 3.6-8 8v256c0 4.4 3.6 8 8 8zm216-432H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"project",theme:"outlined"},S=function(e,t){return o.exports.createElement(u,Object.assign({},e,{ref:t,icon:R}))};S.displayName="ProjectOutlined";var A=o.exports.forwardRef(S),B={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M666.7 505.5l-246-178A8 8 0 00408 334v46.9c0 10.2 4.9 19.9 13.2 25.9L566.6 512 421.2 617.2c-8.3 6-13.2 15.6-13.2 25.9V690c0 6.5 7.4 10.3 12.7 6.5l246-178c4.4-3.2 4.4-9.8 0-13z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"right-circle",theme:"outlined"},D=function(e,t){return o.exports.createElement(u,Object.assign({},e,{ref:t,icon:B}))};D.displayName="RightCircleOutlined";var F=o.exports.forwardRef(D),T={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"},K=function(e,t){return o.exports.createElement(u,Object.assign({},e,{ref:t,icon:T}))};K.displayName="UnorderedListOutlined";var U=o.exports.forwardRef(K);const $=i`
  mutation fileOpenInEditor($input: OpenInEditorInput!) {
    fileOpenInEditor(input: $input)
  }
`;i`
  query lastImportPath {
    lastImportPath
  }
`;const{TabPane:G}=f,J=({projectList:e=[],removeProject:t,goDashboard:a})=>{const[r,c]=o.exports.useState(null),[n,{data:l,error:s,loading:i}]=p($);return d.createElement("section",{className:"project-select-list container-center tabs-content-auto"},e&&e.map((e=>d.createElement("div",{className:"project-select-list-item",key:e.id},d.createElement("div",{className:"content"},d.createElement("div",{className:"content-icon"},d.createElement(A,{style:{fontSize:22}})),d.createElement("div",{className:"content-left",onClick:()=>a({id:e.id})},d.createElement("div",{className:"name"},e.name),d.createElement("div",{className:"path"},e.name)),d.createElement("div",{className:"content-right"},d.createElement("span",{className:"open",onClick:()=>(e=>{i||(c(e),n({variables:{input:{file:e.path}}}))})(e)},d.createElement(V,null)," 在编辑器中打开 ",i&&e===r&&d.createElement(E,null)),d.createElement("span",{className:"delete",onClick:()=>t(e)},d.createElement(g,null))))))),e&&0===e.length&&d.createElement("div",{className:"empty flex-center"},"没有项目哦，去导入吧~"))},Q=({projectData:e,requestImportToProject:t,requestFiles:a})=>{o.exports.useRef(null);const[r,c]=o.exports.useState(!1),{currentPath:n=[],isPackage:l=!1,files:s=[]}=e||{},{request:i,loading:m}=v("/api/project/verifyDirs",{lazy:!0}),p=e=>{const t=e.target.value.split("/");i({targetPath:t}).then((()=>{c(!1),a({rootPathArr:t})})).catch((()=>{c(!1)}))};return d.createElement("div",{className:"project-import container-center tabs-content-auto"},d.createElement("div",{className:"toolbar"},d.createElement("div",{className:"back flex-center",onClick:()=>{const e=[...n];e.pop(),e.length>1&&a({rootPathArr:e})}},d.createElement(P,null)),d.createElement("div",{className:"current-path"},n.map(((e,t)=>d.createElement("div",{key:e,className:"path-part flex-center",onClick:()=>((e,t)=>{if(t===n.length-1||!e)return;const r=[...n].splice(0,t+1);a({rootPathArr:r})})(e,t)},e))),r&&d.createElement("div",{className:"edit-path"},d.createElement(b,{id:"search-input",defaultValue:n.join("/"),onPressEnter:p}))),d.createElement("div",{className:"edit flex-center",onClick:()=>{const e=document.getElementById("search-input");if(e&&e.value){const{value:t}=e;p({target:{value:t}})}c(!r)}},!r&&d.createElement(L,null),r&&d.createElement(F,null))),d.createElement("div",{className:"folders"},d.createElement(W,{files:s,goNextFile:e=>{const t=[...n,e];a({rootPathArr:t})}})),d.createElement("div",{className:"import-btn"},d.createElement("button",{className:""+(l?"":"disabled"),onClick:()=>{l&&t({importPath:n})}},d.createElement(N,null)," 导入这个文件夹")))},W=({files:e,goNextFile:r})=>d.createElement("div",null,e&&e.map((e=>d.createElement("div",{className:"folder-explorer-item",key:e,onClick:()=>r(e)},d.createElement("div",{className:"icon flex-center"},(()=>{const r={fontSize:18},c=(n=s({},r),t(n,a({color:"#168bff"})));var n;return e.includes(".json")?d.createElement(j,{style:s({},r)}):d.createElement(y,{style:c})})()),d.createElement("div",{className:"folder-name"},e)))),e&&0===e.length&&d.createElement("div",{className:"empty flex-center"},"该目录没有文件~"));export default()=>{const[e,t]=o.exports.useState("1"),a=m(),{request:r,data:c,loading:n}=v("/api/user/folder",{errorMsg:!1}),{request:l,data:i=[],loading:p}=v("/api/project/list"),{request:u,loading:E}=v("/api/project/dashboard",{lazy:!0,onSuccess:()=>{a.push("/")}}),{request:g,loading:b}=v("/api/project/remove",{lazy:!0,onSuccess:()=>{N()}}),N=e=>{l(e)};return d.createElement("section",{className:"ui-container"},d.createElement("div",{className:"title"},"Oumi UI 项目管理器"),d.createElement("div",{className:"ui-tabs"},d.createElement(f,{defaultActiveKey:"1",activeKey:e,onChange:e=>t(e)},d.createElement(G,{key:"1",tab:d.createElement("span",null,d.createElement(U,null),"项目")},d.createElement(J,{projectList:i,removeProject:g,goDashboard:u})),d.createElement(G,{key:"2",tab:d.createElement("span",null,d.createElement(q,null),"导入")},d.createElement(Q,{requestImportToProject:e=>{x.post("/api/project/import",s({},e)).then((e=>{N(),t("1")}))},projectData:c,requestFiles:e=>{r(e)}}))),(n||p)&&d.createElement("div",{className:"loading flex-center"},d.createElement(h,null))))};
